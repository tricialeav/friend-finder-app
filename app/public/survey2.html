<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
        crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <title>Friend Finder App</title>
</head>

<body>
    <div class="container">
        <div class="page-header">
            <h1>Survey Questions</h1>
        </div>
        <div class="page-header">
            <h3>About you</h3>
            <!-- Form start -->
            <form class="form-horizontal">
                <div class="form-group">
                    <label for="name" class="col-sm-2 control-label">Name (Required):</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="nameInput" placeholder="Jane Doe">
                    </div>
                </div>
                <div class="form-group">
                    <label for="photoLink" class="col-sm-2 control-label">URL Link to Photo (Required):</label>
                    <div class="col-sm-10">
                        <input type="url" class="form-control" id="photoLink">
                    </div>
                </div>
            </form>
        </div>
        <h3 class="text-center">Choose your answers below, with 1 being "Strongly Disagree" and 5 being "Strongly Agree"</h3>
        <!-- Survey Start -->
        <h3>Question 1</h3>
        <div class="form-group">
            <label for="sel1">I enjoy being creative.</label>
            <select class="form-control" id="sel1">
                <option value="" selected disabled>Please Select</option>
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
            </select>
        </div>
        <h3>Question 2</h3>
        <div class="form-group">
            <label for="sel1">I prefer variety over routine.</label>
            <select class="form-control" id="sel2">
                <option value="" selected disabled>Please Select</option>
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
            </select>
        </div>
        <h3>Question 3</h3>
        <div class="form-group">
            <label for="sel1">I talk to many different people at parties.</label>
            <select class="form-control" id="sel3">
                <option value="" selected disabled>Please Select</option>
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
            </select>
        </div>
        <h3>Question 4</h3>
        <div class="form-group">
            <label for="sel1">I feel other people's emotions.</label>
            <select class="form-control" id="sel4">
                <option value="" selected disabled>Please Select</option>
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
            </select>
        </div>
        <h3>Question 5</h3>
        <div class="form-group">
            <label for="sel1">I dislike confrontation.</label>
            <select class="form-control" id="sel5">
                <option value="" selected disabled>Please Select</option>
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
            </select>
        </div>
        <h3>Question 6</h3>
        <div class="form-group">
            <label for="sel1">I prefer cooperation over competition.</label>
            <select class="form-control" id="sel6">
                <option value="" selected disabled>Please Select</option>
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
            </select>
        </div>
        <h3>Question 7</h3>
        <div class="form-group">
            <label for="sel1">I like to seek adventure.</label>
            <select class="form-control" id="sel7">
                <option value="" selected disabled>Please Select</option>
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
            </select>
        </div>
        <h3>Question 8</h3>
        <div class="form-group">
            <label for="sel1">I believe in fate.</label>
            <select class="form-control" id="sel8">
                <option value="" selected disabled>Please Select</option>
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
            </select>
        </div>
        <h3>Question 9</h3>
        <div class="form-group">
            <label for="sel1">I enjoy reading a good book.</label>
            <select class="form-control" id="sel9">
                <option value="" selected disabled>Please Select</option>
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
            </select>
        </div>
        <h3>Question 10</h3>
        <div class="form-group">
            <label for="sel1">I believe that only I am in charge of my own destiny.</label>
            <select class="form-control" id="sel10">
                <option value="" selected disabled>Please Select</option>
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
            </select>
        </div>
        <br>
        <button type="submit" class="btn btn-primary btn-lg btn-block" id="submit">
            <span class="glyphicon glyphicon-ok-sign" aria-hidden="true"></span>
            Submit</button>
        <br>
        <br>
        <footer class="footer">
            <div class="container">
                <p>
                    <a href="/api/friends">API Friends List</a> |
                    <a href="https://github.com/tricialeav/friend-finder-app" target="_blank">GitHub Repo</a>
                </p>
            </div>
        </footer>
        <br>
        <br>
        <!-- Modal Start -->
        <div id="results-modal" class="modal fade" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h2 class="modal-title text-center">
                            <strong>You matched with...</strong>
                        </h2>
                    </div>
                    <div class="modal-body text-center">
                        <h2 id="matchName" class="text-center"></h2>
                        <img id="matchImg" src="#" alt="Photo of your match" class="rounded mx-auto d-bloc" style="width:250px">
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
</body>
<script type="text/javascript">
    // User submits form, creates new friend object
    $("#submit").on("click", function (event) {
        event.preventDefault();
        var newFriend = {
            name: $("#nameInput").val().trim(),
            photo: $("#photoLink").val().trim(),
            scores: []
        };
        // Push score values into scores array
        for (var i = 1; i <= 10; i++) {
            let numbers = parseInt($("#sel" + i).val());
            newFriend.scores.push(numbers);
        }
        // Validate name and photo link have been entery (this only checks if text is entered into fields). If so, push data to the friends array. TODO verify survey question entry. 
        if (newFriend.name !== "" && newFriend.photo !== "") {
            $.ajax({
                url: "/api/friends",
                type: "POST",
                data: JSON.stringify(newFriend),
                contentType: "application/json",
                success: function (data) {
                    if (data) {
                        // Return modal with match
                        $("#matchName").text(data.name);
                        $("#matchImg").attr("src", data.photo);
                        $("#results-modal").modal("toggle");
                    }
                    else {
                        console.log("[LOG] Error posting");
                    }
                }
            });

        } else if (newFriend.name === "" && newFriend.photo === "") {
            $("#nameInput").css("border", "solid 1px red");
            $("#photoLink").css("border", "solid 1px red");
        } else if (newFriend.name === "") {
            $("#nameInput").css("border", "solid 1px red");
        } else {
            $("#photoLink").css("border", "solid 1px red");
        }
    });
</script>